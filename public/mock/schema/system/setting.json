{
  "data": {
    "loading": false,
    "activeTab": "basic",
    "basicForm": {
      "siteName": "",
      "siteDescription": "",
      "siteLogo": "",
      "siteFavicon": "",
      "copyright": "",
      "icp": ""
    },
    "securityForm": {
      "passwordMinLength": 6,
      "passwordRequireUppercase": true,
      "passwordRequireLowercase": true,
      "passwordRequireNumber": true,
      "passwordRequireSpecial": false,
      "loginMaxAttempts": 5,
      "loginLockDuration": 30,
      "sessionTimeout": 120,
      "enableCaptcha": true
    },
    "emailForm": {
      "smtpHost": "",
      "smtpPort": 465,
      "smtpUser": "",
      "smtpPassword": "",
      "smtpEncryption": "ssl",
      "senderName": "",
      "senderEmail": ""
    },
    "storageForm": {
      "storageType": "local",
      "localPath": "/uploads",
      "ossEndpoint": "",
      "ossAccessKey": "",
      "ossSecretKey": "",
      "ossBucket": "",
      "maxFileSize": 10,
      "allowedExtensions": "jpg,jpeg,png,gif,pdf,doc,docx,xls,xlsx"
    },
    "encryptionOptions": [
      { "label": "SSL", "value": "ssl" },
      { "label": "TLS", "value": "tls" },
      { "label": "无", "value": "none" }
    ],
    "storageTypeOptions": [
      { "label": "本地存储", "value": "local" },
      { "label": "阿里云 OSS", "value": "oss" },
      { "label": "腾讯云 COS", "value": "cos" },
      { "label": "七牛云", "value": "qiniu" }
    ]
  },
  "methods": {
    "loadSettings": [
      { "set": "loading", "value": true },
      {
        "fetch": "/mock/api/system/settings.json",
        "method": "GET",
        "then": [
          { "set": "basicForm", "value": "{{ $response.basic || basicForm }}" },
          { "set": "securityForm", "value": "{{ $response.security || securityForm }}" },
          { "set": "emailForm", "value": "{{ $response.email || emailForm }}" },
          { "set": "storageForm", "value": "{{ $response.storage || storageForm }}" }
        ],
        "catch": [
          { "call": "$message.error", "args": ["{{ $error.message || '加载设置失败' }}"] }
        ],
        "finally": [
          { "set": "loading", "value": false }
        ]
      }
    ],
    "saveBasicSettings": [
      { "set": "loading", "value": true },
      {
        "fetch": "/mock/api/system/settings/basic",
        "method": "PUT",
        "body": "{{ basicForm }}",
        "then": [
          { "call": "$message.success", "args": ["基本设置保存成功"] }
        ],
        "catch": [
          { "call": "$message.error", "args": ["{{ $error.message || '保存失败' }}"] }
        ],
        "finally": [
          { "set": "loading", "value": false }
        ]
      }
    ],
    "saveSecuritySettings": [
      { "set": "loading", "value": true },
      {
        "fetch": "/mock/api/system/settings/security",
        "method": "PUT",
        "body": "{{ securityForm }}",
        "then": [
          { "call": "$message.success", "args": ["安全设置保存成功"] }
        ],
        "catch": [
          { "call": "$message.error", "args": ["{{ $error.message || '保存失败' }}"] }
        ],
        "finally": [
          { "set": "loading", "value": false }
        ]
      }
    ],
    "saveEmailSettings": [
      { "set": "loading", "value": true },
      {
        "fetch": "/mock/api/system/settings/email",
        "method": "PUT",
        "body": "{{ emailForm }}",
        "then": [
          { "call": "$message.success", "args": ["邮件设置保存成功"] }
        ],
        "catch": [
          { "call": "$message.error", "args": ["{{ $error.message || '保存失败' }}"] }
        ],
        "finally": [
          { "set": "loading", "value": false }
        ]
      }
    ],
    "testEmailSettings": [
      { "set": "loading", "value": true },
      {
        "fetch": "/mock/api/system/settings/email/test",
        "method": "POST",
        "body": "{{ emailForm }}",
        "then": [
          { "call": "$message.success", "args": ["测试邮件发送成功，请检查收件箱"] }
        ],
        "catch": [
          { "call": "$message.error", "args": ["{{ $error.message || '测试邮件发送失败' }}"] }
        ],
        "finally": [
          { "set": "loading", "value": false }
        ]
      }
    ],
    "saveStorageSettings": [
      { "set": "loading", "value": true },
      {
        "fetch": "/mock/api/system/settings/storage",
        "method": "PUT",
        "body": "{{ storageForm }}",
        "then": [
          { "call": "$message.success", "args": ["存储设置保存成功"] }
        ],
        "catch": [
          { "call": "$message.error", "args": ["{{ $error.message || '保存失败' }}"] }
        ],
        "finally": [
          { "set": "loading", "value": false }
        ]
      }
    ]
  },
  "onMounted": { "call": "loadSettings" },
  "com": "NCard",
  "props": {
    "title": "系统设置"
  },
  "children": [
    {
      "com": "NSpin",
      "props": {
        "show": "{{ loading }}"
      },
      "children": [
        {
          "com": "NTabs",
          "model": "activeTab",
          "props": {
            "type": "line"
          },
          "children": [
            {
              "com": "NTabPane",
              "props": {
                "name": "basic",
                "tab": "基本设置"
              },
              "children": [
                {
                  "com": "NForm",
                  "props": {
                    "model": "{{ basicForm }}",
                    "labelPlacement": "left",
                    "labelWidth": 120,
                    "class": "max-w-600px"
                  },
                  "children": [
                    {
                      "com": "NFormItem",
                      "props": {
                        "label": "网站名称"
                      },
                      "children": [
                        {
                          "com": "NInput",
                          "model": "basicForm.siteName",
                          "props": {
                            "placeholder": "请输入网站名称"
                          }
                        }
                      ]
                    },
                    {
                      "com": "NFormItem",
                      "props": {
                        "label": "网站描述"
                      },
                      "children": [
                        {
                          "com": "NInput",
                          "model": "basicForm.siteDescription",
                          "props": {
                            "type": "textarea",
                            "placeholder": "请输入网站描述",
                            "rows": 3
                          }
                        }
                      ]
                    },
                    {
                      "com": "NFormItem",
                      "props": {
                        "label": "网站 Logo"
                      },
                      "children": [
                        {
                          "com": "NInput",
                          "model": "basicForm.siteLogo",
                          "props": {
                            "placeholder": "请输入 Logo 地址"
                          }
                        }
                      ]
                    },
                    {
                      "com": "NFormItem",
                      "props": {
                        "label": "网站图标"
                      },
                      "children": [
                        {
                          "com": "NInput",
                          "model": "basicForm.siteFavicon",
                          "props": {
                            "placeholder": "请输入 Favicon 地址"
                          }
                        }
                      ]
                    },
                    {
                      "com": "NFormItem",
                      "props": {
                        "label": "版权信息"
                      },
                      "children": [
                        {
                          "com": "NInput",
                          "model": "basicForm.copyright",
                          "props": {
                            "placeholder": "请输入版权信息"
                          }
                        }
                      ]
                    },
                    {
                      "com": "NFormItem",
                      "props": {
                        "label": "ICP 备案号"
                      },
                      "children": [
                        {
                          "com": "NInput",
                          "model": "basicForm.icp",
                          "props": {
                            "placeholder": "请输入 ICP 备案号"
                          }
                        }
                      ]
                    },
                    {
                      "com": "NFormItem",
                      "children": [
                        {
                          "com": "NButton",
                          "props": {
                            "type": "primary"
                          },
                          "events": {
                            "click": { "call": "saveBasicSettings" }
                          },
                          "children": "保存设置"
                        }
                      ]
                    }
                  ]
                }
              ]
            },
            {
              "com": "NTabPane",
              "props": {
                "name": "security",
                "tab": "安全设置"
              },
              "children": [
                {
                  "com": "NForm",
                  "props": {
                    "model": "{{ securityForm }}",
                    "labelPlacement": "left",
                    "labelWidth": 150,
                    "class": "max-w-600px"
                  },
                  "children": [
                    {
                      "com": "NDivider",
                      "props": {
                        "titlePlacement": "left"
                      },
                      "children": "密码策略"
                    },
                    {
                      "com": "NFormItem",
                      "props": {
                        "label": "最小密码长度"
                      },
                      "children": [
                        {
                          "com": "NInputNumber",
                          "model": "securityForm.passwordMinLength",
                          "props": {
                            "min": 6,
                            "max": 32
                          }
                        }
                      ]
                    },
                    {
                      "com": "NFormItem",
                      "props": {
                        "label": "要求大写字母"
                      },
                      "children": [
                        {
                          "com": "NSwitch",
                          "model": "securityForm.passwordRequireUppercase"
                        }
                      ]
                    },
                    {
                      "com": "NFormItem",
                      "props": {
                        "label": "要求小写字母"
                      },
                      "children": [
                        {
                          "com": "NSwitch",
                          "model": "securityForm.passwordRequireLowercase"
                        }
                      ]
                    },
                    {
                      "com": "NFormItem",
                      "props": {
                        "label": "要求数字"
                      },
                      "children": [
                        {
                          "com": "NSwitch",
                          "model": "securityForm.passwordRequireNumber"
                        }
                      ]
                    },
                    {
                      "com": "NFormItem",
                      "props": {
                        "label": "要求特殊字符"
                      },
                      "children": [
                        {
                          "com": "NSwitch",
                          "model": "securityForm.passwordRequireSpecial"
                        }
                      ]
                    },
                    {
                      "com": "NDivider",
                      "props": {
                        "titlePlacement": "left"
                      },
                      "children": "登录安全"
                    },
                    {
                      "com": "NFormItem",
                      "props": {
                        "label": "最大登录尝试次数"
                      },
                      "children": [
                        {
                          "com": "NInputNumber",
                          "model": "securityForm.loginMaxAttempts",
                          "props": {
                            "min": 3,
                            "max": 10
                          }
                        }
                      ]
                    },
                    {
                      "com": "NFormItem",
                      "props": {
                        "label": "锁定时长（分钟）"
                      },
                      "children": [
                        {
                          "com": "NInputNumber",
                          "model": "securityForm.loginLockDuration",
                          "props": {
                            "min": 5,
                            "max": 1440
                          }
                        }
                      ]
                    },
                    {
                      "com": "NFormItem",
                      "props": {
                        "label": "会话超时（分钟）"
                      },
                      "children": [
                        {
                          "com": "NInputNumber",
                          "model": "securityForm.sessionTimeout",
                          "props": {
                            "min": 30,
                            "max": 1440
                          }
                        }
                      ]
                    },
                    {
                      "com": "NFormItem",
                      "props": {
                        "label": "启用验证码"
                      },
                      "children": [
                        {
                          "com": "NSwitch",
                          "model": "securityForm.enableCaptcha"
                        }
                      ]
                    },
                    {
                      "com": "NFormItem",
                      "children": [
                        {
                          "com": "NButton",
                          "props": {
                            "type": "primary"
                          },
                          "events": {
                            "click": { "call": "saveSecuritySettings" }
                          },
                          "children": "保存设置"
                        }
                      ]
                    }
                  ]
                }
              ]
            },
            {
              "com": "NTabPane",
              "props": {
                "name": "email",
                "tab": "邮件设置"
              },
              "children": [
                {
                  "com": "NForm",
                  "props": {
                    "model": "{{ emailForm }}",
                    "labelPlacement": "left",
                    "labelWidth": 120,
                    "class": "max-w-600px"
                  },
                  "children": [
                    {
                      "com": "NFormItem",
                      "props": {
                        "label": "SMTP 服务器"
                      },
                      "children": [
                        {
                          "com": "NInput",
                          "model": "emailForm.smtpHost",
                          "props": {
                            "placeholder": "如：smtp.example.com"
                          }
                        }
                      ]
                    },
                    {
                      "com": "NFormItem",
                      "props": {
                        "label": "SMTP 端口"
                      },
                      "children": [
                        {
                          "com": "NInputNumber",
                          "model": "emailForm.smtpPort",
                          "props": {
                            "min": 1,
                            "max": 65535
                          }
                        }
                      ]
                    },
                    {
                      "com": "NFormItem",
                      "props": {
                        "label": "SMTP 用户名"
                      },
                      "children": [
                        {
                          "com": "NInput",
                          "model": "emailForm.smtpUser",
                          "props": {
                            "placeholder": "请输入 SMTP 用户名"
                          }
                        }
                      ]
                    },
                    {
                      "com": "NFormItem",
                      "props": {
                        "label": "SMTP 密码"
                      },
                      "children": [
                        {
                          "com": "NInput",
                          "model": "emailForm.smtpPassword",
                          "props": {
                            "type": "password",
                            "placeholder": "请输入 SMTP 密码",
                            "showPasswordOn": "click"
                          }
                        }
                      ]
                    },
                    {
                      "com": "NFormItem",
                      "props": {
                        "label": "加密方式"
                      },
                      "children": [
                        {
                          "com": "NSelect",
                          "model": "emailForm.smtpEncryption",
                          "props": {
                            "options": "{{ encryptionOptions }}"
                          }
                        }
                      ]
                    },
                    {
                      "com": "NFormItem",
                      "props": {
                        "label": "发件人名称"
                      },
                      "children": [
                        {
                          "com": "NInput",
                          "model": "emailForm.senderName",
                          "props": {
                            "placeholder": "请输入发件人名称"
                          }
                        }
                      ]
                    },
                    {
                      "com": "NFormItem",
                      "props": {
                        "label": "发件人邮箱"
                      },
                      "children": [
                        {
                          "com": "NInput",
                          "model": "emailForm.senderEmail",
                          "props": {
                            "placeholder": "请输入发件人邮箱"
                          }
                        }
                      ]
                    },
                    {
                      "com": "NFormItem",
                      "children": [
                        {
                          "com": "NSpace",
                          "children": [
                            {
                              "com": "NButton",
                              "props": {
                                "type": "primary"
                              },
                              "events": {
                                "click": { "call": "saveEmailSettings" }
                              },
                              "children": "保存设置"
                            },
                            {
                              "com": "NButton",
                              "events": {
                                "click": { "call": "testEmailSettings" }
                              },
                              "children": "发送测试邮件"
                            }
                          ]
                        }
                      ]
                    }
                  ]
                }
              ]
            },
            {
              "com": "NTabPane",
              "props": {
                "name": "storage",
                "tab": "存储设置"
              },
              "children": [
                {
                  "com": "NForm",
                  "props": {
                    "model": "{{ storageForm }}",
                    "labelPlacement": "left",
                    "labelWidth": 120,
                    "class": "max-w-600px"
                  },
                  "children": [
                    {
                      "com": "NFormItem",
                      "props": {
                        "label": "存储类型"
                      },
                      "children": [
                        {
                          "com": "NSelect",
                          "model": "storageForm.storageType",
                          "props": {
                            "options": "{{ storageTypeOptions }}"
                          }
                        }
                      ]
                    },
                    {
                      "com": "NFormItem",
                      "if": "{{ storageForm.storageType === 'local' }}",
                      "props": {
                        "label": "本地路径"
                      },
                      "children": [
                        {
                          "com": "NInput",
                          "model": "storageForm.localPath",
                          "props": {
                            "placeholder": "请输入本地存储路径"
                          }
                        }
                      ]
                    },
                    {
                      "com": "NFormItem",
                      "if": "{{ storageForm.storageType === 'oss' }}",
                      "props": {
                        "label": "OSS Endpoint"
                      },
                      "children": [
                        {
                          "com": "NInput",
                          "model": "storageForm.ossEndpoint",
                          "props": {
                            "placeholder": "请输入 OSS Endpoint"
                          }
                        }
                      ]
                    },
                    {
                      "com": "NFormItem",
                      "if": "{{ storageForm.storageType === 'oss' }}",
                      "props": {
                        "label": "Access Key"
                      },
                      "children": [
                        {
                          "com": "NInput",
                          "model": "storageForm.ossAccessKey",
                          "props": {
                            "placeholder": "请输入 Access Key"
                          }
                        }
                      ]
                    },
                    {
                      "com": "NFormItem",
                      "if": "{{ storageForm.storageType === 'oss' }}",
                      "props": {
                        "label": "Secret Key"
                      },
                      "children": [
                        {
                          "com": "NInput",
                          "model": "storageForm.ossSecretKey",
                          "props": {
                            "type": "password",
                            "placeholder": "请输入 Secret Key",
                            "showPasswordOn": "click"
                          }
                        }
                      ]
                    },
                    {
                      "com": "NFormItem",
                      "if": "{{ storageForm.storageType === 'oss' }}",
                      "props": {
                        "label": "Bucket"
                      },
                      "children": [
                        {
                          "com": "NInput",
                          "model": "storageForm.ossBucket",
                          "props": {
                            "placeholder": "请输入 Bucket 名称"
                          }
                        }
                      ]
                    },
                    {
                      "com": "NDivider",
                      "props": {
                        "titlePlacement": "left"
                      },
                      "children": "上传限制"
                    },
                    {
                      "com": "NFormItem",
                      "props": {
                        "label": "最大文件大小(MB)"
                      },
                      "children": [
                        {
                          "com": "NInputNumber",
                          "model": "storageForm.maxFileSize",
                          "props": {
                            "min": 1,
                            "max": 100
                          }
                        }
                      ]
                    },
                    {
                      "com": "NFormItem",
                      "props": {
                        "label": "允许的扩展名"
                      },
                      "children": [
                        {
                          "com": "NInput",
                          "model": "storageForm.allowedExtensions",
                          "props": {
                            "placeholder": "多个扩展名用逗号分隔"
                          }
                        }
                      ]
                    },
                    {
                      "com": "NFormItem",
                      "children": [
                        {
                          "com": "NButton",
                          "props": {
                            "type": "primary"
                          },
                          "events": {
                            "click": { "call": "saveStorageSettings" }
                          },
                          "children": "保存设置"
                        }
                      ]
                    }
                  ]
                }
              ]
            }
          ]
        }
      ]
    }
  ]
}
